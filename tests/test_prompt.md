我现在正在实现一个AI语音克隆提供网站，其中:

- `voiceclone-pro-console`是前端代码库，负责用户界面和交互。
- `backend`是后端代码库，处理API请求和数据管理。
- `tests`包含当前的自动化测试脚本和当前测试状态。
- `run_frontend_and_backend.sh`是一个脚本，你可以使用`run_frontend_and_backend.sh start`来启动前端和后端服务。使用`run_frontend_and_backend.sh stop`来停止它们。
你需要忽略`.gitignore`文件中列出的文件和目录。

现在你需要遵照TDD原则，先完成如下测试的编写，测试放到文件夹`./tests`中，你需要选择合适的skills和工具来实现这些测试。
<desc>目前用户上传的音频和生成的音频都存储在阿里云OSS中，我需要在"语音生成"-->"声音克隆"上传音频处让用户可以查看曾经上传的音频文件列表。请编写一个E2E测试，确保前端正确调用后端API获取用户上传的音频文件列表，并在前端界面正确显示这些文件名和上传时间。</desc>
<test1>
1. 用户使用`xiaowu.417@qq.com`,密码`1234qwer`登录系统。
2. 用户导航到"语音生成"-->"声音克隆"页面。
3. 用户选择`./data/audio/1229.MP3`文件进行上传，进行声音克隆。系统扣掉相应分数。
4. 上传成功后，用户刷新页面，可以在音色列表中看到克隆的声音，在上传文件处看到刚才上传的音频文件名和上传时间。
5. 用户选择用已经上传的文件再次进行声音克隆，确认可以正常使用该文件进行克隆，生成新的音色。
5. 用户选择删除刚才上传的音频文件，确认删除成功，上传文件列表中不再显示该文件。且阿里云OSS中该文件也被删除。但是音色列表中的两个克隆声音仍然保留。
</test1>
<test2>
1. 用户运行test1。
2. 用户登出，再次用相同账号登录系统。
3. 用户导航到"语音生成"-->"声音克隆"页面，用户选择`./data/audio/1230.MP3`文件进行上传，进行声音克隆。系统扣掉相应分数。
4. 上传成功后，用户即使不刷新页面，也可以在音色列表中看到克隆的声音，在上传文件处看到刚才上传的音频文件名和上传时间。
5. 用户在生成历史中下载刚才生成的声音，并且选择删除该生成的语音，确认删除成功，生成历史中不再显示该生成记录。且阿里云OSS中该文件也被删除。但是音色列表中的克隆声音仍然保留。
</test2>
<test3>
1. 用户运行test1.
2. 用户删除刚刚创建的音色，系统弹出确认删除对话框，用户确认删除。删除的方式是调用fish-audio的删除音色API。(你可以参考`https://docs.fish.audio/api-reference/endpoint/model/delete-model`来实现测试)。
3. 用户确认删除成功，音色列表中不再显示该音色。且fish-audio平台中该音色也被删除。
</test3>

<desc>
接下来我需要测试"声音库"的功能是否完整且正常，你需要编写E2E测试来覆盖以下场景
</desc>
<test4>
1. 用户运行test1.
2. 用户导航到"语音生成"-->"声音库"页面，确认刚刚创建的音色出现在声音库中。
3. 用户选择刚刚创建的音色，点击"应用音色"按钮，系统跳转到工作台页面，确认该音色已被选择。
4. 用户在工作台页面输入文本"你好，这是一个测试。(高兴)"，并选择生成语音，确认前端发送到后端的请求体中，文本被正确转换为"你好，这是一个测试。(Happy)"。
5. 用户确认语音生成请求被正确发送到fish-audio TTS API，并且生成状态和下载链接在前端界面正确显示。
6. 用户导航到生成历史页面，确认生成历史中只包含了刚才出现的声音。
7. 用户点击删除生成历史中的该记录，确认删除成功，生成历史中不再显示该记录。且阿里云OSS中该文件也被删除。
</test4>


<test5>
1. 用户运行test1.
2. 用户导航到"声音库"页面，确认所有音色块都没有"试听样品"按钮.
3. 用户导航到"语音生成"-->"声音克隆"界面，点击某个最近上传的音频，弹出"再次克隆"对话框，没有"重命名”按钮。
4. 用户导航到"声音库"页面，点击右上角的"克隆新声音"按钮，系统跳转到"声音克隆"界面。
</test5>
所有测试运行完后，其产生的log，上传的文件，生成的音色和音频都被清空。

我现在正在实现一个AI语音克隆提供网站，其中:
- `voiceclone-pro-console`是前端代码库，负责用户界面和交互。
- `backend`是后端代码库，处理API请求和数据管理。
- `tests`包含当前的自动化测试脚本和当前测试状态。
- `run_frontend_and_backend.sh`是一个脚本，你可以使用`run_frontend_and_backend.sh start`来启动前端和后端服务。使用`run_frontend_and_backend.sh stop`来停止它们。
你需要忽略`.gitignore`文件中列出的文件和目录。

现在你需要遵照TDD原则，先完成如下测试的编写，测试放到文件夹`./tests`中，你需要选择合适的skills和工具来实现这些测试。你需要修改test6以保证符合下列的需求：
<desc>前端所有显示预定义音色/系统音色的地方都应该是*硬编码*，可以直接被用户使用用来生成新声音的</desc>
<test6>
1. 用户打开前端，停留在首页1秒，然后点击登录按钮。
2. 用户使用`xiaowu.417@qq.com`,密码`1234qwer`登录系统。
3. 用户导航到"语音生成"-->"声音克隆"页面, 前端组件"我的声音库"-->"系统预设已经显示了硬编码系统预定义音色。"声音克隆"处不显示系统预定义音色。
4. 依次选择所有的系统预定义音色，确认可以正常使用这些系统预定义音色来直接生成语音。同时，确认"我的创作"中不会出现新音色（因为用户使用的是预定义音色直接生成音频，没有创建新音色）。
5. 用户导航到"声音库"页面，前端组件"预定义音色"和"全部音色"都显示了系统预定义音色。
6. 用户导航到首页，刷新，再导航到用户导航到"声音库"页面，预定义音色仍然存在。
7. 用户在"声音库"界面点击"试听样品"按钮，确认可以正常播放这些预定义音色的试听样品。同时音色在播放时，显示播放动画效果，用户再次点击"试听样品"按钮，确认可以暂停播放。
8. 用户在"声音库"界面点击"应用音色"按钮，系统跳转到工作台页面，确认该预定义音色已被选择。
9. 用户在工作台页面输入文本"你好，这是一个测试 test6。"，
10. 用户删除刚刚生成的所有声音，确认删除成功，但是系统预定义的音色不会被删除, 也不会显示删除按钮，生成历史中不再显示这些记录。且阿里云oss中该文件也被删除。
11. 退出登录，刷新界面，重新登录，确认系统预定义音色在"语音生成"-->"声音克隆"页面, 前端组件"我的声音库"-->"系统预设"显示了系统预定义音色。在"声音库"页面，前端组件"预定义音色"和"全部音色"都显示了系统预定义音色。
</test6>
你需要保证网页可以正常打开，并测试可以通过。

# test6测试通过，但是前端没有展示系统预定义音色，你需要修改前端代码来展示这些预定义音色，并确保test6测试通过。

<desc>接下来你需要完成并发测试</desc>



我现在正在实现一个AI语音克隆提供网站，其中:

- `voiceclone-pro-console`是前端代码库，负责用户界面和交互。
- `backend`是后端代码库，处理API请求和数据管理。
- `tests`包含当前的自动化测试脚本和当前测试状态。
- `run_frontend_and_backend.sh`是一个脚本，你可以使用`run_frontend_and_backend.sh start`来启动前端和后端服务。使用`run_frontend_and_backend.sh stop`来停止它们。
你需要忽略`.gitignore`文件中列出的文件和目录。

现在你需要遵照TDD原则，先完成如下测试的编写，测试放到文件夹`./tests`中，你需要选择合适的skills和工具来实现这些测试。你需要修改test6以保证符合下列的需求：
<test7>
1. 用户使用`xiaowu.417@qq.com`,密码`1234qwer`登录系统。
2. 用户导航到"语音生成"-->"声音克隆"页面。
3. 用户选择`./data/audio/1229.MP3`文件进行上传，进行声音克隆。系统扣掉相应分数。
4. 上传成功后，用户刷新页面，可以在音色列表中看到克隆的声音，在上传文件处看到刚才上传的音频文件名和上传时间。
5. 用户马上导航到"语音生成"-->"声音库"页面，确认刚刚创建的音色出现在声音库中，显示"正在生成"。
6. 用户等待一段时间，确认声音库中该音色状态变为"生成完成"。
7. 用户导航到"语音生成"-->"声音克隆"页面，确认刚刚创建的音色出现在"我的声音库"中。声音库内的音色状态跟"声音克隆"页面内的音色状态一致应该随时保持一致。
</test7>

<test8>
1. 用户使用`xiaowu.417@qq.com`,密码`1234qwer`登录系统。
2. 用户导航到"语音生成"-->"声音克隆"页面。
3. 用户选择`./data/audio/1229.MP3`文件进行上传，进行声音克隆。系统扣掉相应分数。
4. 上传成功后，用户刷新页面，可以在音色列表中看到克隆的声音，在上传文件处看到刚才上传的音频文件名和上传时间。
5. 用户马上导航到"语音生成"-->"声音库"页面，确认刚刚创建的音色出现在声音库中，显示"正在生成"。
6. 用户直接删除该正在生成的音色，弹出确认删除对话框，用户确认删除。确认删除成功，声音库中不再显示该音色。且fish-audio平台中该音色也被删除。
7. 用户导航到"语音生成"-->"声音克隆"页面，确认刚刚创建的音色不会出现在"我的声音库"中。声音库内的音色状态跟"声音克隆"页面内的音色状态一致应该随时保持一致。
</test8>

<test9>
1. 用户使用`xiaowu.417@qq.com`,密码`1234qwer`登录系统。
2. 用户导航到"语音生成"-->"声音克隆"页面。
3. 用户选择`./data/audio/1229.MP3`文件进行上传，进行声音克隆。系统扣掉相应分数。
4. 上传成功后，用户刷新页面，可以在音色列表中看到克隆的声音，在上传文件处看到刚才上传的音频文件名和上传时间。
5. 用户接着选择合成语速为1，输入"测试生成速度1"进行生成，确认生成请求被正确发送到fish-audio TTS API，并且生成状态和下载链接在前端界面正确显示。
6. 用户接着选择合成语速为1.5，输入"测试生成速度1.5"进行生成，确认生成请求被正确发送到fish-audio TTS API，并且生成状态和下载链接在前端界面正确显示。
7. 用户接着选择合成语速为0.8，输入"测试生成速度0.8"进行生成，确认生成请求被正确发送到fish-audio TTS API，并且生成状态和下载链接在前端界面正确显示。
8. 用户删除刚刚生成的所有声音，确认删除成功，生成历史中不再显示这些记录。且阿里云oss中该文件也被删除。
9. 用户删除刚刚创建的音色，系统弹出确认删除对话框，用户确认删除。删除的方式是调用fish-audio的删除音色API。(你可以参考`https://docs.fish.audio/api-reference/endpoint/model/delete-model`来实现测试)。
</test9>


我现在正在实现一个AI语音克隆提供网站，其中:
- `voiceclone-pro-console`是前端代码库，负责用户界面和交互。
- `backend`是后端代码库，处理API请求和数据管理。
- `tests`包含当前的自动化测试脚本和当前测试状态。
- `run_frontend_and_backend.sh`是一个脚本，你可以使用`run_frontend_and_backend.sh start`来启动前端和后端服务。使用`run_frontend_and_backend.sh stop`来停止它们。
你需要忽略`.gitignore`文件中列出的文件和目录。

现在你需要遵照TDD原则，先完成如下测试的编写，测试放到文件夹`./tests`中，你需要选择合适的skills和工具来实现这些测试。
<desc>
你需要先实现并积分系统，确保在用户上传音频进行声音克隆时，前端正确调用后端API扣除相应积分，并在前端界面实时更新用户的积分余额显示。积分规则如下:
<credit_rule>
1. 用户上传音频创建音色不收费，免费用户限制创建5个音色，VIP付费用户无限制。
2. 只要充过钱的用户都是VIP付费用户。需要记录。
3. 新用户注册送5000积分。
4. 积分在用户使用音色生成语音时扣除，扣除规则如下:
   - 每10000积分对应114000 UTF8num，你需要计算用户输入的文本/上传的文本文件里的UTF8 num数，然后按比例扣除积分。Utf8 num数的计算方式是计算文本的UTF8编码后的字节数。
   - 扣除积分= (输入文本UTF8num数 / 114000) * 10000，结果四舍五入取整。
   - 最低扣除积分为100积分。
   - 每生成语音最多输入5000个UTF8num，超过则拒绝输入。提示"该输入过长，无法生成语音"。
   - 如果用户积分余额不足以支付本次生成所需积分，系统应拒绝该生成请求，并在前端界面显示“积分余额不足，请充值”提示。
   - 测试账号`xiaowu.417@qq.com`无限积分，是VIP付费用户。
</credit_rule>
积分充值功能先空缺，目前假设所有充值操作都正确完成，用户账户积分余额会正确更新。完成对下面积分系统测试的编写。
</desc>
请编写E2E测试来覆盖以下场景:
<test10>
1. 打开首页，停留1秒，点击登录按钮。
2. 注册一个新用户, 使用邮箱`newuser@example.com`，密码`password123`进行注册。
3. 登录新注册的用户，确认积分余额显示为5000积分。
4. 导航到"语音生成"-->"声音克隆"页面。
5. 上传音频文件`./data/audio/1229.MP3`进行声音克隆，确认上传成功且积分余额未减少。
6. 使用新创建的音色生成语音，输入文本`tests/input_txt/input1.txt`，计算UTF8 num数，判断计算的num数是否为711，确认积分按规则扣除了62(四舍五入取62)，且前端积分余额实时更新。
7. 使用新创建的音色生成语音，输入`tests/input_txt/input2.txt`内的文本，计算处UTF8数为3614，确认积分按规则扣除了317(round)，且前端积分余额实时更新。
8. 使用新创建的音色生成语音，输入`tests/input_txt/input3.txt`内的文本，计算出UTF8 num数为5805，超过了5000，因此提示"该输入过长，无法生成语音"。
9. 退出登录。
10. 注销此账号，在后端数据库中确认该用户记录被删除，在阿里云OSS和后端该用户上传的音频文件，生成的语音都被删除。
</test10>
<test11>
1. 打开首页，停留1秒，点击登录按钮。
2. 注册一个新用户, 使用邮箱`newuser@example.com`，密码`password123`进行注册。
3. 登录新注册的用户，确认积分余额显示为5000积分。
4. 导航到"语音生成"-->"声音克隆"页面。
5. 上传音频文件`./data/audio/1229.MP3`进行声音克隆，确认上传成功且积分余额未减少。
6. 将该用户的积分手动修改为50积分。
7. 使用新创建的音色生成语音，输入文本`tests/input_txt/input1.txt`，计算UTF8 num数，判断计算的num数是否为711，确认积分按规则扣除了62(四舍五入取62)，且前端积分余额实时更新。
8. 使用新创建的音色生成语音，输入`tests/input_txt/input2.txt`内的文本，计算处UTF8num数为3614，积分按规则应扣除317(round)，但是当前余额不足，因此拒绝该生成请求，并在前端界面显示“积分余额不足，请充值”提示，提示内有直达充值界面的按钮。
9. 退出登录。
10. 注销此账号，在后端数据库中确认该用户记录被删除，在阿里云OSS和后端该用户上传的音频文件，生成的语音都被删除。
</test11>
<test12>
1. 使用测试账号`xiaowu.417@qq.com`登录，确认积分显示为无限积分。
2. 导航到"语音生成"-->"声音克隆"页面。
3. 上传音频文件`./data/audio/1229.MP3`进行声音克隆，确认上传成功且积分余额未减少。
4. 使用新创建的音色生成语音，输入文本`tests/input_txt/input1.txt`，计算UTF8 num数，判断计算的num数是否为711，计算积分按规则应该扣除62，但是这个是无限积分账号，因此确认积分余额仍然显示为无限积分。
5. 使用新创建的音色生成语音，输入`tests/input_txt/input2.txt`内的文本，计算处UTF8 num数为3614，积分按规则应扣除317(round)，但是这个是无限积分账号，因此确认积分余额仍然显示为无限积分。
6. 使用新创建的音色生成语音，输入`tests/input_txt/input3.txt`内的文本，计算出UTF8 num数为5805，超过了5000，因此提示"该输入过长，无法生成语音"。
7. 退出登录。
8. 删除该账号上传的音频文件，生成的语音文件，在后端和阿里云OSS中确认删除成功。
</test12>
编写完成这些测试后运行它们，确保它们通过。如果不通过，你需要反思测试和代码，找出问题所在并修正它们，直到所有测试通过。